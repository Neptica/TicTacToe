import { Request, Response } from "express";
import { Friends } from "../models/friends";
import { BadRequestException } from "~/config/error.core";

class FriendService {
  public SendRequest(req: Request, res: Response) {
    const playerId = req.body.playerId;
    if (!playerId) {
      throw new BadRequestException("No playerId found attached to call");
    }
    Friends.aggregate([
      {
        $match: {
          $or: [{ playerId1: playerId, playerId2: playerId }],
        },
      },
      {
        $project: {
          _id: 0,
          otherField: {
            $cond: [
              { $eq: ["$playerId1", playerId] },
              "$playerId1",
              "$playerId2",
            ],
          },
        },
      },
    ]);
  }
}

export const friendService = new FriendService();
